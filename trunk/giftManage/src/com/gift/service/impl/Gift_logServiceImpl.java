package com.gift.service.impl;import java.io.File;import java.io.FileInputStream;import java.io.FileNotFoundException;import java.io.FileOutputStream;import java.io.InputStream;import java.io.OutputStream;import java.util.List;import javax.annotation.Resource;import org.apache.poi.hssf.usermodel.HSSFCell;import org.apache.poi.hssf.usermodel.HSSFRow;import org.apache.poi.hssf.usermodel.HSSFSheet;import org.apache.poi.hssf.usermodel.HSSFWorkbook;import org.springframework.stereotype.Service;import org.springframework.transaction.annotation.Transactional;import com.gift.bean.Gift_log;import com.gift.dao.Gift_logDAO;import com.gift.service.Gift_logService;/** * @Repository @Service @Controller，它们分别对应存储层Bean，业务层Bean，和展示层Bean。 * @Component泛指组件，当组件不好归类的时候，我们可以使用这个注解进行标注。 * @scope="prototype"来保证每一个请求有一个单独的Action来处理， 避免struts中Action的线程安全问题。 */@Servicepublic class Gift_logServiceImpl implements Gift_logService {	private Gift_logDAO gift_logDao;	public Gift_logDAO getGift_logDao() {		return gift_logDao;	}	@Resource(name = "gift_logDAOImpl")	public void setGift_logDao(Gift_logDAO gift_logDao) {		this.gift_logDao = gift_logDao;	}	@Transactional	public void delete(Gift_log gift_log) {		this.gift_logDao.removeGift_log(gift_log);	}	public List<Gift_log> findAll() {		return this.gift_logDao.findAllGift_log();	}	public Gift_log findByLog_id(Integer log_id) {		return this.gift_logDao.findGift_logByLog_id(log_id);	}	@Transactional	public void save(Gift_log gift_log) {		this.gift_logDao.saveGift_log(gift_log);	}	@Transactional	public void update(Gift_log gift_log) {		this.gift_logDao.updateGift_log(gift_log);	}	public int findGift_logByLog_content_count(String log_content_c) {		return this.gift_logDao.findGift_logByLog_content_count(log_content_c);	}	public List<Gift_log> findGift_logByLog_content(String log_content_c,			int currentPage, int lineSize) {		return this.gift_logDao.findGift_logByLog_content(log_content_c,				currentPage, lineSize);	}	public List<Gift_log> findGift_logByLog_content_excel(String log_content_c) {		return this.gift_logDao.findGift_logByLog_content_excel(log_content_c);	}	@SuppressWarnings("deprecation")	public InputStream getInputStream(String log_content_c) {		HSSFWorkbook wb = new HSSFWorkbook();		HSSFSheet sheet = wb.createSheet("RecordsSheet");		HSSFRow row = sheet.createRow(0);		HSSFCell cell = row.createCell((short) 0);		cell.setCellValue("log_id");		cell = row.createCell((short) 1);		cell.setCellValue("log_content");		cell = row.createCell((short) 2);		cell.setCellValue("log_uri");		cell = row.createCell((short) 3);		cell.setCellValue("log_type");		cell = row.createCell((short) 4);		cell.setCellValue("add_time");		cell = row.createCell((short) 5);		cell.setCellValue("add_user_id");		List<Gift_log> list;		if (log_content_c.equals("")) {			list = this.findAll();		} else {			list = this.findGift_logByLog_content_excel(log_content_c);		}		for (int i = 0; i < list.size(); ++i) {			Gift_log gift_log = list.get(i);			row = sheet.createRow(i + 1);			cell = row.createCell((short) 0);			if (gift_log.getLog_id() != null) {				cell.setCellValue(gift_log.getLog_id());			} else {				cell.setCellValue("");			}			cell = row.createCell((short) 1);			if (gift_log.getLog_content() != null) {				cell.setCellValue(gift_log.getLog_content());			} else {				cell.setCellValue("");			}			cell = row.createCell((short) 2);			if (gift_log.getLog_uri() != null) {				cell.setCellValue(gift_log.getLog_uri());			} else {				cell.setCellValue("");			}			cell = row.createCell((short) 3);			if (gift_log.getLog_type() != null) {				cell.setCellValue(gift_log.getLog_type());			} else {				cell.setCellValue("");			}			cell = row.createCell((short) 4);			if (gift_log.getAdd_time() != null) {				cell.setCellValue(gift_log.getAdd_time());			} else {				cell.setCellValue("");			}			cell = row.createCell((short) 5);			if (gift_log.getAdd_user_id() != null) {				cell.setCellValue(gift_log.getAdd_user_id());			} else {				cell.setCellValue("");			}		}		File file = new File("test.xls");		try {			OutputStream os = new FileOutputStream(file);			wb.write(os);			os.close();		} catch (Exception e) {			e.printStackTrace();		}		InputStream is = null;		try {			is = new FileInputStream(file);		} catch (FileNotFoundException e) {			e.printStackTrace();		}		return is;	}}