package com.gift.service.impl;import java.io.File;import java.io.FileInputStream;import java.io.FileNotFoundException;import java.io.FileOutputStream;import java.io.InputStream;import java.io.OutputStream;import java.util.List;import javax.annotation.Resource;import org.apache.poi.hssf.usermodel.HSSFCell;import org.apache.poi.hssf.usermodel.HSSFRow;import org.apache.poi.hssf.usermodel.HSSFSheet;import org.apache.poi.hssf.usermodel.HSSFWorkbook;import org.springframework.stereotype.Service;import org.springframework.transaction.annotation.Transactional;import com.gift.bean.Gift_code;import com.gift.dao.Gift_codeDAO;import com.gift.service.Gift_codeService;/** * @Repository @Service @Controller，它们分别对应存储层Bean，业务层Bean，和展示层Bean。 * @Component泛指组件，当组件不好归类的时候，我们可以使用这个注解进行标注。 * @scope="prototype"来保证每一个请求有一个单独的Action来处理， 避免struts中Action的线程安全问题。 */@Servicepublic class Gift_codeServiceImpl implements Gift_codeService {	private Gift_codeDAO gift_codeDao;	public Gift_codeDAO getGift_codeDao() {		return gift_codeDao;	}	@Resource(name = "gift_codeDAOImpl")	public void setGift_codeDao(Gift_codeDAO gift_codeDao) {		this.gift_codeDao = gift_codeDao;	}	@Transactional	public void delete(Gift_code gift_code) {		this.gift_codeDao.removeGift_code(gift_code);	}	public List<Gift_code> findAll() {		return this.gift_codeDao.findAllGift_code();	}	public Gift_code findByPk_id(Integer pk_id) {		return this.gift_codeDao.findGift_codeByPk_id(pk_id);	}	@Transactional	public void save(Gift_code gift_code) {		this.gift_codeDao.saveGift_code(gift_code);	}	@Transactional	public void update(Gift_code gift_code) {		this.gift_codeDao.updateGift_code(gift_code);	}	public int findGift_codeByName_count(String name_c) {		return this.gift_codeDao.findGift_codeByName_count(name_c);	}	public List<Gift_code> findGift_codeByName(String name_c, int currentPage,			int lineSize) {		return this.gift_codeDao.findGift_codeByName(name_c, currentPage,				lineSize);	}	public List<Gift_code> findGift_codeByName_excel(String name_c) {		return this.gift_codeDao.findGift_codeByName_excel(name_c);	}	@SuppressWarnings("deprecation")	public InputStream getInputStream(String name_c) {		HSSFWorkbook wb = new HSSFWorkbook();		HSSFSheet sheet = wb.createSheet("RecordsSheet");		HSSFRow row = sheet.createRow(0);		HSSFCell cell = row.createCell((short) 0);		cell.setCellValue("pk_id");		cell = row.createCell((short) 1);		cell.setCellValue("name");		cell = row.createCell((short) 2);		cell.setCellValue("code");		cell = row.createCell((short) 3);		cell.setCellValue("parent_code");		cell = row.createCell((short) 4);		cell.setCellValue("create_time");		cell = row.createCell((short) 5);		cell.setCellValue("add_user_id");		List<Gift_code> list;		if (name_c.equals("")) {			list = this.findAll();		} else {			list = this.findGift_codeByName_excel(name_c);		}		for (int i = 0; i < list.size(); ++i) {			Gift_code gift_code = list.get(i);			row = sheet.createRow(i + 1);			cell = row.createCell((short) 0);			if (gift_code.getPk_id() != null) {				cell.setCellValue(gift_code.getPk_id());			} else {				cell.setCellValue("");			}			cell = row.createCell((short) 1);			if (gift_code.getName() != null) {				cell.setCellValue(gift_code.getName());			} else {				cell.setCellValue("");			}			cell = row.createCell((short) 2);			if (gift_code.getCode() != null) {				cell.setCellValue(gift_code.getCode());			} else {				cell.setCellValue("");			}			cell = row.createCell((short) 3);			if (gift_code.getParent_code() != null) {				cell.setCellValue(gift_code.getParent_code());			} else {				cell.setCellValue("");			}			cell = row.createCell((short) 4);			if (gift_code.getCreate_time() != null) {				cell.setCellValue(gift_code.getCreate_time());			} else {				cell.setCellValue("");			}			cell = row.createCell((short) 5);			if (gift_code.getAdd_user_id() != null) {				cell.setCellValue(gift_code.getAdd_user_id());			} else {				cell.setCellValue("");			}		}		File file = new File("test.xls");		try {			OutputStream os = new FileOutputStream(file);			wb.write(os);			os.close();		} catch (Exception e) {			e.printStackTrace();		}		InputStream is = null;		try {			is = new FileInputStream(file);		} catch (FileNotFoundException e) {			e.printStackTrace();		}		return is;	}}