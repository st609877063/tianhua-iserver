package com.gift.action.gift_operation;import java.io.ByteArrayOutputStream;import java.io.InputStream;import java.io.PrintStream;import java.util.Map;import javax.annotation.Resource;import javax.servlet.http.HttpServletRequest;import org.apache.log4j.Logger;import org.apache.struts2.ServletActionContext;import org.springframework.stereotype.Controller;import com.gift.action.BaseAction;import com.gift.bean.Gift_operation;import com.gift.service.Gift_operationService;import com.opensymphony.xwork2.ActionContext;@Controller@SuppressWarnings({ "unchecked", "rawtypes" })public class Gift_operationAction extends BaseAction {	private static final long serialVersionUID = 1L;	private Gift_operationService service;	private Gift_operation gift_operation;	private String oper_name_c;	// 调用分页默认值	int currentPage = 1; // 定义没页要显示的记录数	int lineSize = 10; // 总记录数 / 每页显示的记录数	int allRecorders;	public Gift_operationService getService() {		return service;	}	@Resource(name = "gift_operationServiceImpl")	public void setService(Gift_operationService service) {		this.service = service;	}	public Gift_operation getGift_operation() {		return gift_operation;	}	public void setGift_operation(Gift_operation gift_operation) {		this.gift_operation = gift_operation;	}	public int getCurrentPage() {		return currentPage;	}	public void setCurrentPage(int currentPage) {		this.currentPage = currentPage;	}	public String getOper_name_c() {		return oper_name_c;	}	public void setOper_name_c(String oper_name_c) {		HttpServletRequest request = ServletActionContext.getRequest();		if (request.getMethod().equals("POST")) {			this.oper_name_c = oper_name_c;		} else {			try {				this.oper_name_c = oper_name_c;			} catch (Exception e) {			}		}	}	public String list() throws Exception {		Map request = (Map) ActionContext.getContext().get("request");		request.put("list", service.findAll());		return "listsuccess";	}	public String saveP() throws Exception {		return "saveP";	}	public String save() throws Exception {		try {			this.service.save(this.gift_operation);			return "savesuccess";		} catch (Exception e) {			ByteArrayOutputStream msg = new ByteArrayOutputStream();			e.printStackTrace(new PrintStream(msg));			addActionError("保存出错,堆栈信息如下:</BR>" + msg.toString());			Logger logger = Logger.getLogger(this.getClass());			logger.error("programe error !gift_operationsaveAction.java "); // 写到日志文件																			// C:\\log4j_error.log																			// 中			return "saveerror";		}	}	public String updateP() throws Exception {		gift_operation = this.service				.findByOper_id(gift_operation.getOper_id());		return "updateP";	}	public String update() throws Exception {		try {			this.service.update(this.gift_operation);			return "updatesuccess";		} catch (Exception e) {			ByteArrayOutputStream msg = new ByteArrayOutputStream();			e.printStackTrace(new PrintStream(msg));			addActionError("保存出错,堆栈信息如下:</BR>" + msg.toString());			Logger logger = Logger.getLogger(this.getClass());			logger.error("programe error !gift_operationupdateAction.java "); // 写到日志文件																				// C:\\log4j_error.log																				// 中			return "updateerror";		}	}	public String remove() throws Exception {		this.service.delete(gift_operation);		return "removesuccess";	}	public String listByOper_name() throws Exception {		Map request = (Map) ActionContext.getContext().get("request");		if (this.getOper_name_c().equals("")) {			request.put("list", service.findAll());		} else {			allRecorders = service.findGift_operationByOper_name_count(this					.getOper_name_c());			request.put("currentPage", new Integer(currentPage)); // 当前页			request.put("allRecorders", new Integer(allRecorders));// 总记录总数			request.put("list", service.findGift_operationByOper_name(					this.getOper_name_c(), this.getCurrentPage(), lineSize));		}		return "listByOper_name";	}	public InputStream getDownloadFile() {		return this.service.getInputStream(this.getOper_name_c());	}	public String generateExcel() throws Exception {		return "generateExcel";	}}